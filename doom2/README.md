# Doom 2 Mods

Mods based on the capabilities of the GZDoom/Zandronum engines

## WAD Reference

### WAD Header

A WAD file always starts with a 12-byte header. It contains three values:

|Bytes      |Content|
|:---------:|:------- |
|0x00-0x03  | ASCII string "PWAD" or "IWAD", defines whether the WAD is a PWAD or an IWAD|
|0x04-0x07  | An integer specifying the number of entries in the directory|
|0x08-0x0b  |An integer holding a pointer to the location of the directory|

All integers are 4 bytes long in x86-style little-endian order. Their values can never exceed (2^31)-1 since Doom reads them as signed ints.

### WAD Directory

The directory associates names of lumps with the data that belong to them. It consists of a number of entries, each with a length of 16 bytes. The length of the directory is determined by the number given in the WAD header. The structure of each entry is as follows:

|Bytes      |Content|
|:---------:|:------- |
| 0x00-0x03 |An integer holding a pointer to the start of the lump's data in the file|
| 0x04-0x07 |An integer representing the size of the lump in bytes|
| 0x08-0x0f |ASCII string defining the lump's name. Only the characters A-Z (uppercase), 0-9 and []-_ should be used in Lump names (an exception has to be made for some of the ArchVile sprites, which use "\"). The string must be null-terminated if shorter than 8 bytes.|

### WAD Lump Order

For many lumps, where they're located in the WAD is of no consequence, though there are typically some guidelines to make the file easily readable by other people.  For some lumps, however, the location is crucial.

#### Map Data Lumps

_The information here reflects the requirements of the legacy Doom engines only. The UDMF, USDF, or ZSDF map formats have different requirements._

Legacy Doom map names have to be in the format ExMy or MAPzz, where x and y do not exceed 4 and 9 respectively (Ultimate Doom), and zz does not exceed 32 (Doom 2/Final Doom). The named lump is usually empty but can contain data and also marks the start of the map lumps. In order to work properly, the lumps below must follow immediately after the the level name:

| Lump Name | Description |
|:---------:|:----------- |
|THINGS     | A lump listing all the Things present in this map, their X, Y, and Z coordinates, starting angles, type, flags, special, and args.  As with all of these lumps, this list will be generated by your level editor and should generally be left alone. Note: The standard Doom format does not contain Z and args.|
|LINEDEFS   | A list of linedefs, defined by their starting and ending vertices, flags, type, tag, args and front and back sidedefs (if any). Note: The standard Doom format does not contain args.|
|SIDEDEFS   | A list of the sidedefs that are linked to the linedefs.  These contain the data for what textures appear where on the side of each line, their X and Y offsets, and what sector this side of the linedef belongs to.|
|VERTEXES   | A list of each vertex in the map, using X and Y coordinates.|
|SEGS       | A list of lines called "segs" (short for "segments") that connect to form subsectors.|
|SSECTORS   | A list of subsectors, created by your nodes builder.|
|NODES      | The node tree which (Z)Doom uses to speed up the rendering process.  Similar to a vismap in modern 3D games (Such as Quake 3).  Created by your nodes builder.|
|SECTORS    | Defines the floor and ceiling heights and textures, as well as light value, tag, and type of each sector in your map.|
|REJECT     | Optionally compiled by your nodes builder, this lump contains data about which sectors are visible from which other sectors.  Originally, Doom used this to optimize the game speed by skipping AI routines for enemies whose target was in a rejected sector.  Modern machines have no real use for this lump anymore, and so ZDoom has been designed to work even without this lump present.  For compatibility purposes, an empty (0-filled) REJECT lump should be included if nothing else.  The REJECT lump can also be used to create certain special effects (sectors into which enemies can't see, for example) if modified carefully.|
|BLOCKMAP   | Collision-detection information which determines whether objects in a map are touching.|
|BEHAVIOR   | Not originally a part of Doom, the BEHAVIOR lump was first used in Hexen and contains the compiled scripts that this map will use. ZDoom fully supports this lump, regardless of game mode. Vanilla Doom and other ports designed for Doom only will crash when this lump is present because Hexen format levels are not compatible with Doom format levels; not from the presence of the lump itself (as it will be ignored) but by the differences in format of the LINEDEFS and THINGS lumps. This lump is always present for Hexen format levels. Levels without this lump are expected to be Doom format levels.
|SCRIPTS    | ZDoom ignores this lump, but it is good practice to place it in anyway.  It should contain a text (non-compiled) version of the scripts this map uses, so that other people can learn from your work.  If you wish to keep your scripts a secret for whatever reason, you may of course leave this out, but it is considered a courtesy to the community to include it. The name can actually be any name, not just SCRIPTS. Sometimes using a different name is required to be compatible with utilities that will consider multiple SCRIPTS to be the same lump.  Naming them SCRIPT01, SCRIPT02, etc is one way to keep all the names unique and fix that issue|

### Flats, Sprite, and Texture Data Lumps

These resources must be located between special marker lumps so that ZDoom can place them in the proper namespace.  Other than defining the beginning and end of a graphics section, these lumps need not contain any data and are generally zero bytes long; though they could contain data, technically.

| Lump Name  | Description |
|:----------:|:----------- |
|S_START ... S_END | Lump containing IWAD sprite data |
|SS_START ... SS_END | Lump containing PWAD sprite data |
|F_START ... F_END | Lump containing IWAD flats (floor/ceiling textures) data |
|FF_START ... FF_END | Lump containing PWAD flats (floor/ceiling textures) data |
|P_START ... P_END | Lump containing texture patch data. This lump is optional for ZDoom.  |
|**TX_START** ... **TX_END** | ZDoom-specific lump for texture data. Entries in this lump are used in place of any similarly named entry in the sprites, patches, and flats lumps. This also means that any entry in this lump can be used as a flat, sprite, or patch. |
|**HI_START** ... **HI_END** | ZDoom-specific lump for high resolution, scaled texture data. |

**Note:** TX_START / TX_END and HI_START / HI_END aren't required for PK3 or PK7 containers.

### ZDoom Special Lumps

#### Plaintext Lumps

| Lump Name | Description |
|:---------:|:----------- |
|ALTHUDCF   | Used to configure the alternate HUD |
|ANIMDEFS   | Used to define texture animations and switches |
|CVARINFO   | Used to define custom, mod-specific CVARs |
|DECALDEF   | Used to define and animate decals |
|DECORATE   | Used to create new things from scratch |
|DEFBINDS   | Sets default key binds |
|DEHACKED   | For modifying existing vanilla Doom things |
|DEHSUPP    | A special lump that defines what you can change using Dehacked patches _deprecated_|
|DMXGUS     | ''Defines [[GUS]] patch mapping.''
|FSGLOBAL   | ''Global FraggleScript lump.''
|FONTDEFS   | ''Use this lump to create new [[font]]s.''
|GAMEINFO]]| ''Use this lump to define load-time data for a file''
|GLDEFS   | ''Used to define many [[OpenGL]] effects.'' {{OpenGLsmall}}
|IWADINFO ''Used to define the main data file of a stand-alone game.''
|KEYCONF ''Use this lump to create new key bindings in the options menu.''
|LANGUAGE ''Use this lump to modify or adjust strings.''
|LOADACS ''Use this lump to automatically load [[ACS]] objects (even for [[Doom format]] maps).''
|LOCKDEFS ''Use this lump to assign [[key]]s to locks.''
|[MAPINFO ''This lump defines how the game is played, including map settings, map sequences in episodes, ''[[Hexen]]''-style hubs, intermission texts, skill settings, and a lot more.''
|* [[MENUDEF]] ''Used to define custom [[menu]]s.''
|* [[MODELDEF]] ''Used to define [[model]]s.'' {{OpenGLsmall}}
|* [[MUSINFO]] ''Use this lump to define alternate music for maps''
|* [[PALVERS]] ''Use this lump to define paletted versions of truecolor graphics''
|* [[REVERBS]] ''Defines reverb environments for use with the {{Class|SoundEnvironment}} thing.'' '''(Formerly SNDEAX)'''
|* [[S_SKIN]] ''Describes the properties of a custom [[skin]] (player sprite).''
|* [[SBARINFO]] ''Used to create custom [[status bar]]s without the use of ACS.''
|* [[SCRIPTS]] ''This lump usually contains [[ACS]] source for a map, if it exists.''
|* [[SECRETS]] ''This lump contains hints for finding [[secret]]s in maps.''
|* [[SNDINFO]] ''Used to create and define the properties of all sounds.''
|* [[SNDSEQ]] ''This lump creates sound sequences for moving sectors such as doors.''
|* [[TEAMINFO]] ''Defines custom [[team]]s.''
|* [[TERRAIN]] ''This lump can change various properties of floor textures.''
|* [[TEXTCOLO]] ''Use this lump to define new text colors.''
|* [[TEXTURES]] ''ZDoom's advanced texture definition lump, can also define hi-res graphics.'' '''(Formerly HIRESTEX)'''
|* [[TRNSLATE]] ''Contains custom translations for use with actors.''
|* [[VOXELDEF]] ''Use this lump to fine-tune [[voxel]] support.''
|* [[XHAIRS]] ''Used to define new [[crosshair]]s.''
|* [[X11R6RGB]] ''Used to define color names.''
|* '''ZMAPINFO''' ''Alias for MAPINFO. Use ZMAPINFO if you want to avoid breaking compatibility with other ports.'' 
|* [[Intermission script]]s  ''Used to animate or specialize [[intermission]] backdrops.''
|* [[Map arrow]]s ''Used to define the simple vector graphics used in the [[automap]].''
|* [[Map translator]] ''Used to provide alternative translation rules for [[Doom format]] maps.''

## PK3 Reference

| Path     | Description |
|:--------:|:----------- |
|acs/      | contains ACS libraries normally found between A\_START and A\_END |
|colormaps/| contains Boom colormaps normally found between C\_START and C\_END. New ZDoom WADs should not need to use this. |
|filter/   | contains lumps and directories that will only be loaded with specific games. |
|flats/    | contains flats normally found between FF\_START and FF\_END |
|graphics/ | All special graphics like title pictures or font characters must go here. This namespace does not exist in WADs. |
|hires/    | contains high-resolution textures normally found between HI\_START and HI\_END |
|maps/     | contains levels in form of WADs. These WADs must only contain the data for one single level (including GL nodes lumps if required). Any other data in such a WAD will be ignored. Note that the file name and not the map label inside the WAD determines how the map is named in the game. |
|music/    | contains all data that is used as music. This namespace does not exist in WADs. |
|patches/  | contains patches normally found between PP\_START and PP\_END |
|sounds/   | contains all sound files that are referenced by SNDINFO. This namespace does not exist in WADs. |
|sprites/  | contains sprites normally found between S\_START and S\_END (also known as SS\_START, SS\_END) |
|textures/ | contains textures normally found between TX\_START and TX\_END |
|voices/   | contains Strife dialog sounds normally found between V\_START and V\_END |
|voxels/   | contains voxel objects normally found between VX\_START and VX\_END |
